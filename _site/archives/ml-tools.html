<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Machine Learning Softwares | Not a Blog</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Machine Learning Softwares" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Seaborn" />
<meta property="og:description" content="Seaborn" />
<link rel="canonical" href="http://localhost:4000/archives/ml-tools.html" />
<meta property="og:url" content="http://localhost:4000/archives/ml-tools.html" />
<meta property="og:site_name" content="Not a Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-11-01T00:00:00+08:00" />
<script type="application/ld+json">
{"headline":"Machine Learning Softwares","dateModified":"2019-11-01T00:00:00+08:00","datePublished":"2019-11-01T00:00:00+08:00","url":"http://localhost:4000/archives/ml-tools.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/archives/ml-tools.html"},"description":"Seaborn","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="https://fonts.googleapis.com/css?family=Domine|Asap|Noto+Sans+SC|Noto+Serif+SC&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Not a Blog" /></head><body><script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<header class="site-header" role="banner">

  <div class="wrapper"><!-- <a class="site-title" rel="author" href="/">Not a Blog</a> -->
    <!-- <a class="site-title" rel="author" href="/"> $$\mathbb{\text{Not A BB of R2FsCg}}$$ </a> -->
    <a class="site-title" rel="author" href="/" style="font-family: 'Times New Roman'"> Not a Blog of <span style="color: gray;">@R2FsCg</span> </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/links/">Links</a><a class="page-link" href="/tags/">Tags</a><a class="page-link" href="/categories/">Categories</a><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Machine Learning Softwares</h1>
    <p class="post-meta"><time class="dt-published" datetime="2019-11-01T00:00:00+08:00" itemprop="datePublished">Published: Nov 1, 2019</time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 id="seaborn">Seaborn</h1>

<p>Question 1: why <a href="https://seaborn.pydata.org/index.html">Seaborn</a> when we already have <a href="https://matplotlib.org">Matplotlib</a> ?</p>

<p>Seaborn provides a high-level interface to Matplotlib, a powerful but sometimes unwieldy Python visualization library. As put by the official website:</p>
<blockquote>
  <p>If matplotlib “tries to make easy things easy and hard things possible”, seaborn tries to make a well-defined set of hard things easy too.</p>
</blockquote>

<h2 id="functions">Functions</h2>
<p>Making a scatter plot is just one line of code using the <code class="highlighter-rouge">lmplot()</code> function.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Attack'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Defense'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">'whitegrid'</span><span class="p">)</span> <span class="c1"># Set theme
</span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'Type 1'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Attack'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span> <span class="c1"># Violin plot
</span></code></pre></div></div>

<h1 id="tensorflow-20">TensorFlow 2.0</h1>

<h2 id="tfkeras-vs-keras"><code class="highlighter-rouge">tf.keras</code> V.S. <code class="highlighter-rouge">Keras</code></h2>
<p>Keras is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano.</p>

<p>To understand the relationship between <code class="highlighter-rouge">Keras</code> and <code class="highlighter-rouge">tf.keras</code>, we have to clarify the complicated, intertwined relationship between <code class="highlighter-rouge">Keras</code> and <code class="highlighter-rouge">TensorFlow</code>.</p>

<ol>
  <li>2015.03.27, <a href="https://fchollet.com/">Francois Chollet</a> (i.e., the author of Deep Learning with Python) committed and released the first version of Keras to his <a href="https://github.com/fchollet">GitHub</a> to facilitate his own research and experiments.</li>
  <li>Due to its easy-to-use API and the explosion of deep learning popularity, many developers, programmers, and machine learning practitioners flocked to Keras</li>
  <li>At the beginning, the default backend of <code class="highlighter-rouge">Keras</code> was Theano (until v1.1.10)</li>
  <li>Google released TensorFlow on November 9, 2015. Keras started supporting TensorFlow as a backend</li>
  <li>Eventually, TensorFlow became the most popular backend, Keras v1.1.0 switched to TensorFlow as its default backend</li>
  <li>The <code class="highlighter-rouge">tf.keras</code> submodule was introduced in TensorFlow v1.10.0, the first step in integrating <code class="highlighter-rouge">Keras</code> directly within the TensorFlow package itself.</li>
  <li>Keras v2.3.0 was released on September 17, 2019. This is the final release of Keras that will support backend other than TensorFlow. Bugs present in multi-backend Keras will only be fixed until April 2020.</li>
</ol>

<p>To summary, <code class="highlighter-rouge">tf.keras</code> and <code class="highlighter-rouge">Keras</code> are two different modules.</p>

<p><code class="highlighter-rouge">Keras</code> is a high-level API, which at first has nothing to do with TensorFlow, but as the popularity of TF grows, <code class="highlighter-rouge">Keras</code> supported and switched to TF as the default backend. And now, it seems that TF will dominate the future of machine learning, <code class="highlighter-rouge">Keras</code> is integrated into TF.</p>

<p>Tips: It is recommended to use <code class="highlighter-rouge">tf.keras</code> for future projects as the Keras package will only support bug fixes.</p>

<h2 id="how-to-update-to-tensorflow-20">How to update to <code class="highlighter-rouge">TensorFlow 2.0</code></h2>
<p>First of all, a virtual environment is strongly recommended to avoid potential package conflicts.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>virtualenv <span class="nt">--system-site-packages</span> <span class="nt">-p</span> python3 myenv
</code></pre></div></div>
<p>By running the above command, a virtual environment <code class="highlighter-rouge">myenv</code> is created.</p>
<ul>
  <li><code class="highlighter-rouge">--system-site-packages</code> allows the projects within the virtual environment <code class="highlighter-rouge">myenv</code> access the global site-packages. The default setting does not allow this access.</li>
  <li><code class="highlighter-rouge">-p python3</code> is used to set the Python interpreter.</li>
  <li><code class="highlighter-rouge">myenv</code> is the name of the virtual environment we created</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> /myenv/bin/activate
pip <span class="nb">install</span> <span class="nt">--upgrade</span> <span class="nv">tensorflow</span><span class="o">==</span>2.0.0-rc1
</code></pre></div></div>

<p>The above command installs a 2.0.0-rc1 CPU-only version.</p>

<p>To choose the appropriate TensorFlow version, visit <a href="https://www.tensorflow.org/install/pip">https://www.tensorflow.org/install/pip</a></p>

<p>Alternative TensorFlow packages:</p>

<ul>
  <li><code class="highlighter-rouge">tensorflow==2.0.0-rc1</code> Preview TF 2.0 RC build for CPU-only (recommended).</li>
  <li><code class="highlighter-rouge">tensorflow-gpu==2.0.0-rc1</code> Preview TF 2.0 RC build with GPU support</li>
  <li><code class="highlighter-rouge">tensorflow</code> Latest stable release for CPU-only.</li>
  <li><code class="highlighter-rouge">tensorflow-gpu</code> Latest stable release with GPU support.</li>
  <li><code class="highlighter-rouge">tf-nightly</code> Preview nightly build for CPU-only.</li>
  <li><code class="highlighter-rouge">tf-nightly-gpu</code> Preview nightly build with GPU support.</li>
</ul>

<h3 id="test-the-installation">Test the installation</h3>
<pre><code class="language-Python">import tensorflow as tf
print(tf.__version__)
</code></pre>

<h3 id="tensorflow-20-colab">TensorFlow 2.0 Colab</h3>
<p><a href="https://colab.research.google.com">Google Colab</a> is promoting TF 2.0 (current version is still TF 1.5, Nov 14, 2019), if you want to use TF2.0 on Colab, you can manually install it :</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">tensorflow</span><span class="o">-</span><span class="n">gpu</span> <span class="c1"># or tensorflow-gpu==2.0.0-rc1
</span></code></pre></div></div>
<p>Note: you will have to install one of those packages with GPU support, otherwise there is no GPU acceleration even if you set the runtime type to GPU mode.</p>

<h1 id="keras">Keras</h1>
<h2 id="callbacks-">Callbacks ?</h2>
<p>A callback provides a set of functions to be applied at given stages of the training procedure.</p>

<h3 id="earlystopping">EarlyStopping</h3>
<p>Stop training when a monitored quantity has stopped improving.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s">'val_loss'</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>
<p>Arguments:</p>
<ul>
  <li><code class="highlighter-rouge">monitor</code>: quantity to be monitored</li>
  <li><code class="highlighter-rouge">min_delta</code>: minimum change in the monitored quantity to qualify as an improvement, i.e. an absolute change of less than min_delta, will count as no improvement.</li>
  <li><code class="highlighter-rouge">patience</code>: number of epochs that produced the monitored quantity with no improvement after which training will be stopped. Validation quantities may not be produced for every epoch, if the validation frequency (model.fit(validation_freq=5)) is greater than one.</li>
  <li><code class="highlighter-rouge">baseline</code>: Baseline value for the monitored quantity to reach. Training will stop if the model doesn’t show improvement over the baseline.</li>
  <li><code class="highlighter-rouge">restore_best_weights</code>: whether to restore model weights from the epoch with the best value of the monitored quantity. If False, the model weights obtained at the last step of training are used.</li>
  <li><code class="highlighter-rouge">mode</code>: one of {auto, min, max}. In <code class="highlighter-rouge">min</code> mode, training will stop when the quantity monitored has stopped decreasing; in <code class="highlighter-rouge">max</code> mode it will stop when the quantity monitored has stopped increasing; in <code class="highlighter-rouge">auto</code> mode, the direction is automatically inferred from the name of the monitored quantity.</li>
</ul>

<h3 id="reducelronplateau">ReduceLROnPlateau</h3>
<p><strong>Reduce learning rate</strong> when a metric has stopped improving. For example, if <code class="highlighter-rouge">val_loss</code> stayed unreduced in 10 epochs, the learning rate is reduced by 90%, i.e., new_lr = lr * factor.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">reduce_lr</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s">'val_loss'</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">reduce_lr</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="sklearn">Sklearn</h2>
<h3 id="labelencoder">LabelEncoder</h3>
<p>Encode labels with value between 0 and n_classes - 1.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="s">"apple"</span><span class="p">,</span> <span class="s">"pen"</span><span class="p">,</span> <span class="s">"apple"</span><span class="p">,</span> <span class="s">"applepen"</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="c1"># [0, 2, 0, 1]
</span><span class="k">print</span><span class="p">(</span><span class="n">le</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span> <span class="c1"># ['apple', 'pen', 'applepen']
</span></code></pre></div></div>
<h3 id="labelbinarizer">LabelBinarizer</h3>
<p>Very similar to <code class="highlighter-rouge">LabelEncoder</code>, but creating a label indicator matrix, instead an array, from a list of multi-class labels.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lb</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">LabelBinarizer</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">([</span><span class="s">'female'</span><span class="p">,</span> <span class="s">'male'</span><span class="p">,</span> <span class="s">'others'</span><span class="p">,</span> <span class="s">'female'</span><span class="p">]))</span> 
<span class="c1"># [[1, 0, 0], [0, 1, 0], [0, 0, 1], [1, 0, 0]]
</span></code></pre></div></div>

<h3 id="onehotencoder">OneHotEncoder</h3>
<p>Encode categorical integer features as a one-hot numeric array. The input to this transformer must be an array-like of integers or strings, denoting the values taken on by categorical (discrete) features.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">'female'</span><span class="p">,</span> <span class="s">'male'</span><span class="p">,</span> <span class="s">'others'</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="c1"># [[1. 0. 0.], [0. 1. 0.], [0. 0. 1.]]
</span></code></pre></div></div>


  </div>

  <hr>
  <p style="font-family: 'Times New Roman', Times, serif;" align='right'>
    Sharing is caring  
  <a href="https://twitter.com/intent/tweet?text=Machine Learning Softwares&url=http://localhost:4000/archives/ml-tools.html" title="Share on Twitter" rel="nofollow" target="_blank"> <img src="/images/logos/twitterlogo.png" width="50px"> </a>
  <a href="https://facebook.com/sharer/sharer.php?u=http://localhost:4000/archives/ml-tools.html" title="Share on Facebook" target="_blank"> <img src="/images/logos/facebook-logo2.png" width="50px"> </a>
  <a href="http://service.weibo.com/share/share.php?url=http://localhost:4000/archives/ml-tools.html&appkey=&title=Machine Learning Softwares&pic=&ralateUid=&language=zh_cn" title="Share on weibo" rel="nofollow" target="_blank"> <img src="/images/logos/weibo-logo2.jpg" width="50px"> </a>
  </p>

  <p align="right" style="font-family: 'Times New Roman', Times, serif;">Contact me 
    <a href="mailto:deepccccat@aol.com"> 
    <img src="/images/logos/mail-logo.png" width="50px">
    </a></p><a class="u-url" href="/archives/ml-tools.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <!-- <h2 class="footer-heading">Not a Blog</h2> -->
    <!-- <h3 class="footer-heading"> 
      $$\text{A deep learning enthusiast, who believes in the power of AI} $$
      $$\text{ and the ethics of humankind.} $$
    </h3> -->
    <h3 style="font-family: 'Times New Roman', Times, serif; color: gray;" >
      Find the things that really motivate you, and pursue then uncompromisingly.
      Great work only comes when you are doing things that genuinely excite you.
      <!-- A deep learning enthusiast, who believes in the power of AI and the ethics of humankind. -->
    </h3>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name"></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/117ami"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username" style="font-family: 'Times New Roman'"> @R2FsCg </span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer><script src="/scripts/common.js?t=20191227203745"></script>

  

  </body>
</html>